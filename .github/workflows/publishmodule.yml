name: Publish module

on:
  release:
    types: [published]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@main
      
      - uses: actions-ecosystem/action-release-label@v1
        id: release-label
        #with:
        #  github_token: ${{ secrets.GITHUB_TOKEN }}
      # https://github.com/actions-ecosystem/action-get-latest-tag
      - uses: actions-ecosystem/action-get-latest-tag@v1
        id: get-latest-tag
        with:
          semver_only: true
      
      - name: Result
        # run: echo "${{ steps.get-latest-tag.outputs.tag }}"
        run: ./build/publishmodule.ps1 ${{ steps.get-latest-tag.outputs.tag }}
        shell: pwsh
